<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>I Logging Configuration Plugin</title> 
<meta http-equiv="Content-Type" content="text/html; charset="utf-8""> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- html,2,next,javascript,charset="utf-8" --> 
<meta name="src" content="main.tex"> 
<link rel="stylesheet" type="text/css" href="main.css"> 
<script type="text/javascript" src="scripts/shCore.js"></script> 
<script type="text/javascript" src="scripts/shBrushCpp.js"></script> 
<script type="text/javascript" src="scripts/shBrushJava.js"></script> 
<script type="text/javascript" src="scripts/shBrushPython.js"></script> 
<script type="text/javascript" src="scripts/shBrushBash.js"></script> 
<script type="text/javascript" src="scripts/shBrushXml.js"></script> 
<link href="styles/shCore.css" rel="stylesheet" type="text/css" /> 
<link href="styles/shThemeDefault.css" rel="stylesheet" type="text/css" /> 
<script type="text/javascript"> 
SyntaxHighlighter.all() 
</script> 
 </head><body 
>
<link rel="icon" type="image/png" href="images/RedHawk_Logo16x.gif"> 
<script> 
function f() {  
document.getElementById('main_content_wrap').focus(); 
} 
if (window.addEventListener) { 
window.addEventListener("load", f, false); 
} else if (window.attachEvent) { 
window.attachEvent("onload", f); 
} 
</script> 
<div class="header"> 
<ul class="navbar"> 
<li><a class="logo-small" href="index.html"><img src="images/RedHawk_Logo_ALT_B_121px.png"/></a></li> <li><a href="index.html">Home</a></li> 
<li><a class="active" href="documentation.html">Documentation</a></li> 
<li><a href="download.html">Download</a></li> 
<li><a href="community.html">Community</a></li> 
</ul> 
<div class="pattern right"></div> 
<a id="forkme_banner" href="https://github.com/redhawksdr">View on GitHub</a> 
<noscript><div class ="NoScript">WARNING: JAVASCRIPT is not enabled. JAVASCRIPT is required for viewing code snippets.</div></noscript> 
</div> 
<!-- Custom MAIN CONTENT --> 
<div id="main_content_wrap" tabindex="0" class="outer"> 
<section id="main_content" class="inner"> 
<!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="mainap10.html" >next</a>] [<a 
href="mainap8.html" >prev</a>] [<a 
href="mainap8.html#tailmainap8.html" >prev-tail</a>] [<a 
href="#tailmainap9.html">tail</a>] [<a 
href="main.html#mainap9.html" >up</a>] </p></div>
<h2 class="appendixHead"><span class="titlemark">Appendix&#x00A0;I</span><br /><a 
 id="x29-603000I"></a>Logging Configuration Plugin</h2>
<h3 class="sectionHead"><span class="titlemark">I.1   </span> <a 
 id="x29-604000I.1"></a>Introduction</h3>
<!--l. 5--><p class="noindent" >The <a 
href="mainli2.html#glo:domainmanager">Domain Manager</a> may be extended to use a loadable library that can assist in
the resolution of the <span 
class="ectt-1200">LOGGING_CONFIG_URI </span>parameter during application deployments.
The following code and build files provide a template to build the loadable library:
<span 
class="ectt-1200">libossielogcfg.so</span>.
<!--l. 7--><p class="noindent" >The library should be installed in <span 
class="ectt-1200">$OSSIEHOME/lib64 </span>or <span 
class="ectt-1200">$OSSIEHOME/lib </span>depending on your
hardware and operating system. If you choose to install the library in a different directory, you will
need to add this path to <span 
class="ectt-1200">LD_LIBRARY_PATH </span>before starting the <a 
href="mainli2.html#glo:domainmanager">Domain Manager</a>. To enable this
feature in the <a 
href="mainli2.html#glo:domainmanager">Domain Manager</a>, use the <span 
class="ectt-1200">&#8211;-useloglib </span>option when launching the <span 
class="ectt-1200">nodeBooter</span>
program.
<div class="minipage"><script type="syntaxhighlighter" class="brush: bash"><![CDATA[

nodeBooter -D --useloglib

]]></script></div>
<!--l. 16--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">I.2   </span> <a 
 id="x29-605000I.2"></a><span 
class="ectt-1200">LogConfigUriResolver </span>Class and Example</h3>
<!--l. 18--><p class="noindent" >The <span 
class="ectt-1200">LogConfigUriResolver </span>class is the base class that your customized class will inherit. The
class contains a single method <span 
class="ectt-1200">get_uri</span>, that will be used to resolve the logging configuration file
location during deployment. The method accepts a single parameter <span 
class="ectt-1200">path </span>that describes
the resource&#8217;s path in the <span 
class="ectt-1200">Domain</span>. The following list describes the different resource
paths:
      <ul class="itemize1">
      <li class="itemize"><span 
class="ecbx-1200">Component</span>
           <dl class="description"><dt class="description">
                                                                                         
                                                                                         
      <span 
class="ecbx-1200">syntax</span> </dt><dd 
class="description">
                                                                                         
                                                                                         
           <div class="verbatim">
           rsc:&#x003C;DomainName&#x003E;/&#x003C;Application&#x00A0;ID&#x003E;/&#x003C;Component's&#x00A0;Naming&#x00A0;Service&#x00A0;Name&#x003E;
</div>
           <!--l. 23--><p class="nopar" >
           </dd><dt class="description">
      <span 
class="ecbx-1200">example</span> </dt><dd 
class="description">
                                                                                         
                                                                                         
           <div class="verbatim">
           rsc:REDHAWK_DEV/TestWave_2/MyComp_4&#x00A0;
</div>
           <!--l. 24--><p class="nopar" ></dd></dl>
      </li>
      <li class="itemize"><span 
class="ecbx-1200">Device</span>
           <dl class="description"><dt class="description">
      <span 
class="ecbx-1200">syntax</span> </dt><dd 
class="description">
                                                                                         
                                                                                         
           <div class="verbatim">
           dev:&#x003C;DomainName&#x003E;/&#x003C;Node&#x00A0;ID&#x003E;/&#x003C;Device's&#x00A0;Naming&#x00A0;Service&#x00A0;Name&#x003E;
</div>
           <!--l. 28--><p class="nopar" >
           </dd><dt class="description">
      <span 
class="ecbx-1200">example</span> </dt><dd 
class="description">
                                                                                         
                                                                                         
           <div class="verbatim">
           dev:REDHAWK_DEV/Node_1/MyDevice_4&#x00A0;
</div>
           <!--l. 29--><p class="nopar" ></dd></dl>
      </li>
      <li class="itemize"><span 
class="ecbx-1200">Service</span>
           <dl class="description"><dt class="description">
      <span 
class="ecbx-1200">syntax</span> </dt><dd 
class="description">
                                                                                         
                                                                                         
           <div class="verbatim">
           svc:&#x003C;DomainName&#x003E;/&#x003C;Node&#x00A0;ID&#x003E;/&#x003C;Service's&#x00A0;Naming&#x00A0;Service&#x00A0;Name&#x003E;
</div>
           <!--l. 33--><p class="nopar" >
           </dd><dt class="description">
      <span 
class="ecbx-1200">example</span> </dt><dd 
class="description">
                                                                                         
                                                                                         
           <div class="verbatim">
           svc:REDHAWK_DEV/Node_1/MyRedis_3&#x00A0;
</div>
           <!--l. 34--><p class="nopar" ></dd></dl>
      </li></ul>
<!--l. 38--><p class="noindent" >Using this path, the customized code should return the location of a logging configuration file or an
empty string (use current default resolution method). Logging configuration file locations should be
formatted as follows:
      <ul class="itemize1">
      <li class="itemize"><span 
class="ectt-1200">sca://path/to/config/file</span>
           <ul class="itemize2">
           <li class="itemize">sca://logcfg/comp.log.cfg</li></ul>
      </li>
      <li class="itemize"><span 
class="ectt-1200">file:///absolute/path/to/config/file</span>
           <ul class="itemize2">
           <li class="itemize">file:///var/redhawk/sdr/dom/logcfg/comp.log.cfg</li></ul>
      </li></ul>
<!--l. 51--><p class="noindent" >The following example code creates a custom resolver class that provides logging configuration files
from the local <span 
class="ectt-1200">SDRROOT </span>directory (file:///var/redhawk/sdr/dom/logcfg/device.log.cfg). The macro
<span 
class="ectt-1200">MAKE_FACTORY </span>allows the class to be dyamically loaded by the <a 
href="mainli2.html#glo:domainmanager">Domain Manager</a>.
                                                                                         
                                                                                         
<div class="minipage"><script type="syntaxhighlighter" class="brush: cpp"><![CDATA[
[caption=Sample custom logging configuration resolver, captionpos=b]
/*
 * This file is protected by Copyright. Please refer to the COPYRIGHT file
 * distributed with this source distribution.
 *
 * This file is part of REDHAWK core.
 *
 * REDHAWK core is free software: you can redistribute it and/or modify it
 * under the terms of the GNU Lesser General Public License as published by the
 * Free Software Foundation, either version 3 of the License, or (at your
 * option) any later version.
 *
 * REDHAWK core is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public License
 * for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with this program.  If not, see http://www.gnu.org/licenses/.
 */
#include <ossie/logging/LogConfigUriResolver.h>
#include <iostream>
#include <sstream>

class ossielogcfg : public ossie::logging::LogConfigUriResolver {

public:

  ossielogcfg();

  virtual ~ossielogcfg();

  std::string get_uri( const std::string &path );
};


class CustomLogConfigResolver : public ossie::logging::LogConfigUriResolver {

public:

  CustomLogConfigResolver() {};

  virtual ~CustomLogConfigResolver(){};

  /**
     get_uri

     Return a string object that will be passed to a resource on the command line as
     LOGGING_CONFIG_URI parameter. An empty string will be ignored by the DomainManager.

     @param path  Path of the resource in the domain.
                    for components, rsc:<domain name>/<application name>/<component naming service name>
                    e.g.            rsc:REDHAWK_DEV/TestWave_2/MyComp_4

                    for devices, dev:<domain name>/<node name>/<device's naming service name>
                    e.g.            dev:REDHAWK_DEV/Node_1/MyDevice_4

                    for service, svc:<domain name>/<node name>/<service's naming service name>
                    e.g.            svc:REDHAWK_DEV/Node_1/MyRedis_1
  */

  std::string get_uri( const std::string &path ) {

     std::string sdrroot("");
     if ( ::getenv("SDRROOT")){
       sdrroot = ::getenv("SDRROOT");
     }

     if ( path.find("dev:") != std::string::npos ) {
       std::ostringstream os;
       os &lt;&lt; "file://" &lt;&lt; sdrroot &lt;&lt; "/dom/logcfg/device.log.cfg";
       return std::string(os.str());
     }
     if ( path.find("svc:") != std::string::npos ) {
       std::ostringstream os;
       os &lt;&lt; "file://" &lt;&lt; sdrroot &lt;&lt; "/dom/logcfg/serviceq.log.cfg";
       return std::string(os.str());
     }

     if ( path.find("rsc:") != std::string::npos ) {
       std::ostringstream os;
       os &lt;&lt; "file://" &lt;&lt; sdrroot &lt;&lt; "/dom/logcfg/comp.log.cfg";
       return std::string(os.str());
     }
     // an empty string return value will be ignored by the DomainManager
     return std::string("");
  };

};

MAKE_FACTORY(CustomLogConfigResolver);
]]></script>                                                                                         
                                                                                         
</div>
<!--l. 147--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">I.3   </span> <a 
 id="x29-606000I.3"></a>Build Files</h3>
<!--l. 150--><p class="noindent" >Use the following build files to compile and build the above example code in a file called
<span 
class="ectt-1200">ossielogcfg.cpp</span>. The compiled code produces a library called <span 
class="ectt-1200">libossielogcfg.so </span>that is
installed in <span 
class="ectt-1200">$OSSIEHOME/lib </span>or <span 
class="ectt-1200">$OSSIEHOME/lib64</span>. The build process follows the same
paradigm as standard REDHAWK generated software: <span 
class="ectt-1200">reconf; configure; make</span>
<span 
class="ectt-1200">install</span>.
<!--l. 153--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">I.3.1   </span> <a 
 id="x29-607000I.3.1"></a><span 
class="ectt-1200">reconf</span></h4>
<div class="minipage"><script type="syntaxhighlighter" class="brush: cpp"><![CDATA[
#!/bin/sh

rm -f config.cache
[ -d m4 ] || mkdir m4
autoreconf -i
]]></script></div>
<!--l. 163--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">I.3.2   </span> <a 
 id="x29-608000I.3.2"></a><span 
class="ectt-1200">configure.ac</span></h4>
                                                                                         
                                                                                         
<div class="minipage"><script type="syntaxhighlighter" class="brush: cpp"><![CDATA[
AC_INIT(ossielogcfg, 1.0.0)
AM_INIT_AUTOMAKE([nostdinc foreign])
AC_CONFIG_MACRO_DIR([m4])

AC_PROG_CC
AC_PROG_CXX
AC_PROG_INSTALL
AC_PROG_LIBTOOL

AC_CORBA_ORB
OSSIE_CHECK_OSSIE
# TODO: Make this an installed macro
OSSIE_SDRROOT_AS_PREFIX
prefix="${OSSIEHOME}"
libdir="${OSSIEHOME}/lib"
AS_IF( [ test `uname -i` == "x86_64"  ], [ libdir="$prefix/lib64" ], [ libdir="$prefix/lib" ] )

m4_ifdef([AM_SILENT_RULES], [AM_SILENT_RULES([yes])])

# Dependencies
PKG_CHECK_MODULES([REDHAWK], [ossie >= 2.0])
OSSIE_ENABLE_LOG4CXX
AX_BOOST_BASE([1.41])
AX_BOOST_SYSTEM
AX_BOOST_THREAD
AX_BOOST_REGEX

AC_CONFIG_FILES([Makefile ])
AC_OUTPUT
]]></script></div>
<!--l. 197--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">I.3.3   </span> <a 
 id="x29-609000I.3.3"></a><span 
class="ectt-1200">Makefile.am</span></h4>
                                                                                         
                                                                                         
<div class="minipage"><script type="syntaxhighlighter" class="brush: cpp"><![CDATA[
ACLOCAL_AMFLAGS = -I m4 -I${OSSIEHOME}/share/aclocal/ossie
AUTOMAKE_OPTIONS = subdir-objects

lib_LTLIBRARIES = libossielogcfg.la

xmldir = $(prefix)
dist_xml_DATA =

distclean-local:
         rm -rf m4

libossielogcfg_la_SOURCES = ossielogcfg.cpp
libossielogcfg_la_LIBADD = $(REDHAWK_LIBS)
libossielogcfg_la_CPPFLAGS = -I . -I $(srcdir)/include $(REDHAWK_CFLAGS) $(BOOST_CPPFLAGS)
libossielogcfg_la_CXXFLAGS = -Wall
]]></script></div>
                                                                                         
                                                                                         
<!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="mainap10.html" >next</a>] [<a 
href="mainap8.html" >prev</a>] [<a 
href="mainap8.html#tailmainap8.html" >prev-tail</a>] [<a 
href="mainap9.html" >front</a>] [<a 
href="main.html#mainap9.html" >up</a>] </p></div>
<!--l. 1--><p class="noindent" ><a 
 id="tailmainap9.html"></a>   
 
<div class=license>  
<hr> 
<a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/3.0/80x15.png" /></a><br /><span xmlns:dct="http:// purl.org/dc/terms/" property="dct:title">REDHAWK Documentation</span> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>. 
 
</div></section></div> 
</body></html> 
